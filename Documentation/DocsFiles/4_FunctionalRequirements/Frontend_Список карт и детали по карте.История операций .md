# Frontend\_Список карт и детали по карте

**Общие требования к разделу**

По-умолчанию раздел должен быть доступен при наличии у клиента флага доступа flag_cardlist == true. Иначе, раздел не отображается.

Раздел доступен всем клиентам ДБО. Раздел открывается сразу после входа в ДБО и является частью «Главного экрана».

**Макет раздела**
![](C:\Users\Invisible\IdeaProjects\Test_ccoperating\Documentation\Attachments\1.jpg)

# Блок "Карты"

Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/list (без параметров|запрос не параметризован)

В случае если от сервиса получена ошибка или пустой ответ, отображается экран с ошибкой. Текст сообщения «Что-то пошло не так, но мы уже знаем о проблеме…»

В случае если получен успешный ответ, Frontend отображает форму с параметрами:

**Поле** | **Описание**|
|:------------- |:---------------:|
| Блок с картами| Содержит экземпляры data/cards[] ответа сервиса GET api/cards/list Действия:  1) Реквизиты|
| Элемент Карта |   |
| Иконка | Значение data/cards/cardDesign ответа сервиса GET api/cards/list Если значение не получено, отображается иконка по-умолчанию |
| Название карты| Значение data/cards/name В поле отображается 100 символов. Если значение больше, то отображается только часть текста и троеточие. При наведение на такую строку полный текст должен отображаться во всплывающей подсказке.|
| Платежная система | Значение  data/cards/paySystem|
| Номер карты | Значение data/cards/maskedNumber Отображается в формате *XXXX, где XXXX - последние 4 цифры значения |
| Тип карты | Значение data/cards/cardtype В случае если получено значение·        ‘debit’ отобразить текст «Дебетовая»·        ‘credit’ – отобразить текст «Кредитная» |
| Баланс| Значение data/cards/balance По-умолчанию отображается зеленым цветом. В случае если значение отрицательное - отображается красным цветом |
| Статус карты | Если получено значение data/cards/status: •‘active’ - отобразить значение “Активна” •	‘blocked’- отобразить значение “Заблокирована”•	‘inactive’ - отобразить значение “Требует активации”  |

Под каждой картой отображаются действия, доступные с картой:

**Действие** | **Описание**|
|:------------- |:---------------:|
| Реквизиты| tbd TODO|
| Тарифы |  tbd |
| История операций |см. Раздел История операций Элемент представлен ссылкой. По нажатию на ссылку появляется раскрывающийся вниз блокЗаголовок блока меняется в зависимости от раскрытия: “Показать/Скрыть историю операций”|



## История операций
### S.1 Краткая история операций в карте.
### S.2 Общая история операций по картам.
#### S.2.1 Выбор периода,  за который необходимо отобразить полную историю.
### S.1 Краткая история операций в карте.
**Макет шага  S.1**
![](C:\Users\Invisible\IdeaProjects\Test_ccoperating\Documentation\Attachments\2.jpg)
![](C:\Users\Invisible\IdeaProjects\Test_ccoperating\Documentation\Attachments\3.jpg)
**Общие требования**

По умолчанию отображаются  операции за последние 10 дней, но не больше  чем 5.
Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/cardId/history c параметрами

|**Параметр**|**Тип поля**|**Описание**|**Обязательность**|
|:------------- |:---------------:|:---------------:|:---------------:|
|forceRequest|Boolean|Признак принудительного запроса (получение актуальной инфы из АБС)|Да|
|NumberOfOp|Number|Максимальное количество операций, которое нужно вернуть в ответ. Параметр принимает значение не больше 5|Да|
|begindate|String|10 дней до текущей даты|Да|
|enddate|String|Текущая дата|Да|
|Cardid|Number|ИД карты|Да|

1. В случае если от сервиса получен пустой ответ, отображается текст сообщения «Операций по карте не совершалось».
1. В случае если от сервиса получена ошибка, отображается экран с ошибкой. Текст сообщения «Что-то пошло не так, но мы уже знаем о проблеме…»
1. В случае если получен успешный ответ от сервера: Frontend отображает форму с параметрами.

| **Поле** | **Описание**|
|:------------- |:---------------:|
| История операций | Содержит экземпляры data/ cards/cardId/history [] ответа сервиса GET api/cards/cardId/history. Действия:  |
| Элемент истории операций |   |
| Дата совершения операции | Значение data/cards/cardId/history/date. Отображается в формате  yyyy-mm-dd hh:mm:ss |
| Название мерчанта | Значение data/cards/cardId/history/merchant.   В поле отображается 100 символов. Если значение больше, то отображается только часть текста.   При клике на такую строку полный текст должен отображаться во всплывающей подсказке.|
| Название операции | Значение data/cards/cardId/history/name.   В поле отображается 100 символов. Если значение больше, то отображается только часть текста.  При клике на такую строку полный текст должен отображаться во всплывающей подсказке.|
| Сумма операции | Значение data/cards/cardId/history/sum. Операции пополнения отображаются зеленым цветом (в случае если получено значение «Debit » от data/cards/cardsId/history/OPERATIONSTATUS). Операции списания отображаются белым цветом (в случае если получено значение« Credit » от data/cards/cardsId/history/OPERATIONSTATUS) |
| Сумма операции | Значение data/cards/cardId/history/sum. Операции пополнения отображаются зеленым цветом (в случае если получено значение «Debit » от data/cards/cardsId/history/OPERATIONSTATUS). Операции списания отображаются белым цветом (в случае если получено значение« Credit » от data/cards/cardsId/history/OPERATIONSTATUS) |
| Валюта операции | Значение data/cards/cardId/history/currency. Отображается значение Р  |
| Категория операции | Если получено значение data/cards/cardsId/history/category •	‘transport’ - отобразить значение “Транспорт” •	‘pharmacy’- отобразить значение “Аптеки” •	‘supermarkets’ - отобразить значение “Супермаркеты” •	‘others’ - отобразить значение “Другое” •	‘restaurant’ - отобразить значение “Фастфуд” |

4. В случае выбора опции «Общая истории операций по картам» переход к шагу S.2 «Общая история операций по картам».
4. В случае выбора опции «Выбор карты для отображения истории операций» возвращение к блоку «Карты».
### S.2 Общая история операций по картам.
**Макет шага  S.1**

_Здесь должен быть макет_

**Общие требования**

По умолчанию отображаются операции за текущий месяц.
Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/cardId/history c параметрами.

|**Параметр**|**Тип поля**|**Описание**|**Обязательность**|
|:------------- |:---------------:|:---------------:|:---------------:|
|forceRequest|Boolean|Признак принудительного запроса (получение актуальной инфы из АБС)|Да|
|begindate|String|Первая дата текущего месяца|Да|
|enddate|String|Последняя дата текущего месяца|Да|
|Cardid|Number|ИД карты|Да|

1. В случае если от сервиса получен пустой ответ, отображается текст сообщения «Операций по карте не совершалось».
1. В случае если от сервиса получена ошибка, отображается экран с ошибкой. Текст сообщения «Что-то пошло не так, но мы уже знаем о проблеме…»
1. В случае если получен успешный ответ от сервера, Frontend отображает форму с параметрами. Требования к параметрам указаны в пункте 3 шага S.1.
1. В случае выбора опции «Выбор периода» переход к шагу S.2 1 «Выбор периода, за который необходимо отобразить полную историю».
#### S.2.1 Выбор периода,  за который необходимо отобразить полную историю.
**Макет шага  S.2.1**

_Здесь должен быть макет_

Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/cardId/history c параметрами

|**Параметр**|**Тип поля**|**Описание**|**Обязательность**|
|:------------- |:---------------:|:---------------:|:---------------:|
|forceRequest|Boolean|Признак принудительного запроса (получение актуальной инфы из АБС)|Да|
|begindate|String|Указывается клиентом на фронте  в формате yyyy-mm-dd|Да|
|enddate|String|Указывается клиентом на фронте  в формате yyyy-mm-dd|Да|
|Cardid|Number|ИД карты|Да|

1. В случае если от сервиса получен пустой ответ, отображается текст сообщения «Операций по карте не совершалось».
1. В случае если от сервиса получена ошибка, отображается экран с ошибкой. Текст сообщения «Что-то пошло не так, но мы уже знаем о проблеме…»
1. В случае если получен успешный ответ от сервера, Frontend отображает всплывающее окно с предложением для клиента выбрать период (формат yyyy-mm-dd).
